name: 'Run Ansible Playbook (Docker)'
description: 'Reusable Docker-based GitHub Action to run Ansible playbooks.'
author: 'Generated by Copilot'
inputs:
  playbook:
    description: 'Path to the playbook file (relative to workspace) or URL. Example: playbooks/site.yml'
    required: true
  inventory:
    description: 'Path to inventory file (relative to workspace) or inventory string. If omitted, `-i` is not passed.'
    required: false
  playbook_url:
    description: 'Optional: Git URL or HTTP(S) URL to a repo or tarball containing the playbook. If set, repo is cloned into /work/playbook_src and used.'
    required: false
  inventory_url:
    description: 'Optional: URL to inventory (git or HTTP). If set, will be downloaded/cloned to /work/inventory.'
    required: false
  ssh_key_base64:
    description: 'Base64-encoded SSH private key (pass as a secret). The action will decode and write to /root/.ssh/id_rsa.'
    required: true
  ssh_user:
    description: 'SSH user for connecting to hosts (passed to Ansible via `-u`).'
    required: false
    default: ''
  extra_args:
    description: 'Extra arguments to pass to `ansible-playbook` (e.g. "-e key=val --tags tag1").'
    required: false
    default: ''
  strict_host_key_checking:
    description: 'If `false`, sets StrictHostKeyChecking=no during SSH. Default true.'
    required: false
    default: 'true'
  ansible_version:
    description: 'Optional Ansible version to install (pip). Default: latest ansible-core.'
    required: false
    default: ''
outputs: {}
runs:
  using: 'docker'
  image: 'Dockerfile'
  args:
    - '${{ inputs.playbook }}'
    - '${{ inputs.inventory }}'
    - '${{ inputs.playbook_url }}'
    - '${{ inputs.inventory_url }}'
    - '${{ inputs.ssh_key_base64 }}'
    - '${{ inputs.ssh_user }}'
    - '${{ inputs.extra_args }}'
    - '${{ inputs.strict_host_key_checking }}'
    - '${{ inputs.ansible_version }}'